---
title: 'Transaction Processing or Analytics?'
date: '2024-01-15'

summary: ''
draft: false  # ĞµÑĞ»Ğ¸ true - Ğ¿Ğ¾ÑÑ‚ Ğ½Ğµ Ğ±ÑƒĞ´ĞµÑ‚ Ğ¾Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ¾Ğ²Ğ°Ğ½
authors: ['default']  # Ğ°Ğ²Ñ‚Ğ¾Ñ€ Ğ¸Ğ· data/authors/
layout: PostLayout  # Ğ¼Ğ°ĞºĞµÑ‚ Ğ¿Ğ¾ÑÑ‚Ğ°
images: ['/static/images/my-image.jpg']  # Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾: Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ
---


## Introduction to Transactions

In the early days of business data processing, writing to a database typically corresponded to a **commercial transaction**: selling a product ğŸ›ï¸, ordering from a supplier ğŸ“¦, paying employee salaries ğŸ’°, etc. Over time, the term **"transaction"** became established even for operations not related to money and came to mean **a group of read and write operations forming a logical unit**.

> - ğŸ’¥ **Atomicity** â€” the minimum mandatory property of any transaction
> - ğŸ›¡ï¸ **Full ACID** â€” part of reliability for critical operations
> - âš–ï¸ **In practice** â€” different systems choose a balance between reliability (ACID) and performance (weakened guarantees)

## ğŸ”„ OLTP vs OLAP: Two Different Worlds

**Online Transaction Processing (OLTP)** â€” a type of database system used in *transaction-oriented applications* **(banks, accounting systems (ERP, CRM), booking systems, payment systems, etc.)**, such as many operational (core) business systems.

#### Two contexts where the term "transaction" is often used:
**Type 1: Computer Transactions** ğŸ’»
- **Atomic data modification** in a database
- Example: `BEGIN TRANSACTION â†’ UPDATE â†’ COMMIT`

**Type 2: Business Transactions** ğŸ’°
- **Economic exchange** between parties
- Example: product sale, bank transfer

**How they're related:**
OLTP uses **technical transactions (type 1)** to record **business operations (type 2)**.

For example:
- ğŸ’³ *Store purchase* (business transaction)
- is recorded via ğŸ–¥ï¸ *SQL transaction* in the database

**In short:** Technical transactions = tool for recording business transactions ğŸ”§â†’ğŸ“Š

### OLTP (Online Transaction Processing)
Even when databases started being used for various types of data (blog comments ğŸ“, game actions ğŸ®, contacts in address books ğŸ‘¥, etc.), the main access model remained similar to business transaction processing.

**OLTP Characteristics:**
- Searching for a small number of records by key ğŸ”‘
- Inserting and updating data based on user input
- **Interactive** mode of operation

**C Example:**
```c
// Example OLTP operation: finding customer information by ID
#include <stdio.h>
#include <string.h>

struct Customer {
    int id;
    char name[50];
    double balance;
};

struct Customer find_customer_by_id(int customer_id) {
    // In a real system, there would be a database query here
    struct Customer customer;
    customer.id = customer_id;
    strcpy(customer.name, "Ivan Ivanov");
    customer.balance = 15000.75;
    return customer;
}
```

### OLAP (Online Analytic Processing)
**Online Analytical Processing (OLAP)** â€” an approach for quickly answering multidimensional analytical queries.

Databases also started being used for **data analytics**, which implies a completely different access model.

<img src="https://www.techtarget.com/rms/onlineimages/crm-olap_mobile.png" />

> ***Data Warehousing**
> ***OLAP Cube** (from Online Analytical Processing) â€” a multidimensional data structure designed for fast and efficient analysis of large volumes of business data from various perspectives.
> **In simple terms**, an OLAP cube can be compared to a pivot table in Excel, but much more powerful and capable of working with huge amounts of information and multiple parameters (dimensions).

### Let's Look at OLAP-CUBE
<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/52/OLAP_Cube.svg/1024px-OLAP_Cube.svg.png" />

> OLAP data is typically stored in "star" or "snowflake" schemas in a relational data warehouse or specialized data management system. Metrics are derived from records in the fact table, and dimensions are from dimension tables.
> **but**!
> Classic OLAP cubes (like in Microsoft Analysis Services) often store data in proprietary multidimensional formats, not in relational "star" tables. The "star" itself is the raw data storage schema on which the cube is built. Additionally, modern MPP systems (Massively Parallel Processing) like ClickHouse or Amazon Redshift often don't use cubes in the classical sense but provide similar speed for OLAP queries directly to relational tables.

# ğŸ§Š OLAP Cube (Data Cube)

> ğŸ² **The term "cube"** refers to a multidimensional dataset sometimes called a **hypercube** if the number of dimensions is more than three.

### Basic Concepts:

**ğŸ“¦ Cube** â€” a multidimensional generalization of a two-dimensional spreadsheet
```python
# Example: 3D data cube
dimensions = ['Products', 'Time', 'Regions']
measures = ['Sales', 'Profit', 'Budget']
```

# Slice
<img src="https://upload.wikimedia.org/wikipedia/commons/a/a6/OLAP_slicing_en.png" />

> **Slice** - the process of selecting a rectangular subset of a cube by choosing a single value for one of its dimensions, creating a new cube with one less dimension.
> **The figure shows the slicing operation:** sales metrics in all sales regions and all product categories of the company for 2005 and 2006 are "cut out" from the data cube.

---

# Dice
<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c7/OLAP_dicing_en.png/500px-OLAP_dicing_en.png" />

> **Dice:** The dice operation creates a subcube allowing the analyst to select specific values from multiple dimensions.
> **The figure shows the dice operation:** the new cube displays sales data for a limited number of product categories, with time and region dimensions covering the same range as before.

---
# Drill Down/Up

<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9b/OLAP_drill_up%26down_en.png/500px-OLAP_drill_up%26down_en.png" />

> **Drill down/up** allows the user to navigate between data levels, from the most summarized (up) to the most detailed (down).
> **The figure shows the drill-down operation:** the analyst moves from the summary category "Outdoor Protective Equipment" to sales metrics of individual products.

---
# Roll-Up

<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d6/OLAP_pivoting_en.png/500px-OLAP_pivoting_en.png" />

**Roll-up** involves summarizing data along a dimension. The summarization rule can be an aggregate function, for example, to calculate totals along a hierarchy or apply a set of formulas such as **"profit = sales - expenses"**. ğŸ“ŠğŸ’°

## Computational Complexity

Common aggregate functions can be **expensive to compute** when rolling up: âŒ

- ğŸŒ **If they cannot be defined from the cube cells**, they must be computed from the underlying data
- â³ Either compute them **online (slowly)**
- ğŸ’¾ Or **precompute** them for possible roll-up **(large volume)**

## âœ… Efficient Aggregate Functions

Aggregate functions that can be defined from cells are known as **decomposable aggregate functions** and allow **efficient computation**.

## ğŸ’° Cost of Aggregate Functions When Rolling Up

### âŒ Problematic Functions (expensive to compute):

**ğŸ“Š Median (MEDIAN)**
- Requires complete data sorting for each aggregation level
- Lacks the **composability** property - median of subgroups â‰  median of entire group
- On-the-fly computation requires storing all original values

**ğŸ¯ Percentiles (PERCENTILE)**
- Similar to median, require access to the entire dataset
- 90th percentile cannot be computed from 90th percentiles of subgroups
- Must store the complete data distribution

**ğŸ”¢ Mode (MODE)**
- Requires counting frequencies of all values
- The most frequent value in subgroups may not match the overall mode
- Requires complete recount for accurate determination

**ğŸ“ˆ Standard Deviation (STDDEV)**
- Not an **additive** function (In the context of aggregate functions, "additivity" means the ability to compute the overall result from partial results.)
- Requires knowing the mean value and number of elements
- For accurate calculation, need âˆ‘x and âˆ‘xÂ² for all data

### Examples:

**âœ… Easily supported:**
- `COUNT` ğŸ”¢
- `MAXIMUM` â¬†ï¸
- `MINIMUM` â¬‡ï¸
- `SUM` â•

**Because they can be computed for each OLAP cube cell and then rolled up**, since the total sum (or count, etc.) is the sum of sub-sums.

**âŒ Difficult to support:**
- `MEDIAN` ğŸ“Š

**Because it must be computed for each view separately**: the median of a set is **not** the median of medians of subsets.

---

## ğŸ”¢ Mathematical Definition

(simplified) Mathematically, an OLAP cube is a projection of an RDBMS relation:

```
f: (X, Y, Z) â†’ W
```

Where:
- **X, Y, Z** â€” cube axes (dimensions) ğŸ“
- **W** â€” data filling each cell ğŸ’¾

**Projection example:**
```
g: (Product, Time) â†’ Sales
```

## ğŸ’¾ Data Storage

**OLAP data is typically stored in:**
- ğŸŒŸ **Star Schema**
- â„ï¸ **Snowflake Schema**
- ğŸ—„ï¸ Specialized data management systems

### Explanation (briefly)
**ğŸŒŸ Star Schema**
- **Denormalized** schema
- All dimension tables linked **DIRECTLY** to the fact table
- **Simpler and faster** for queries
- Easier to understand

**â„ï¸ Snowflake Schema**
- **Normalized** schema
- Dimension tables **SPLIT** into sub-tables
- **More complex**, but saves space
- Slower due to more JOINs

**What this means in practice:**
- **Star** â†’ for analysis speed ğŸ“Šâš¡
- **Snowflake** â†’ for storage economy ğŸ’¾ğŸ“‰

## Practical Examples

### ğŸ’¼ Business Intelligence:
```python
# Business cube dimensions:
dimensions = [
    'Products ğŸ“¦',
    'Time ğŸ“…',
    'Regions ğŸŒ',
    'Sales_Channels ğŸª',
    'Customers ğŸ‘¥'
]

# Measures (metrics):
measures = [
    'Sales_Volume ğŸ’°',
    'Profit ğŸ“ˆ',
    'Order_Count ğŸ”¢',
    'Average_Check ğŸ’µ'
]
```

### ğŸª Retail Example:
```
Cube: "Store Sales"
â”œâ”€â”€ Dimensions:
â”‚   â”œâ”€â”€ Time: Year â†’ Quarter â†’ Month â†’ Day
â”‚   â”œâ”€â”€ Products: Category â†’ Brand â†’ Model
â”‚   â”œâ”€â”€ Stores: Region â†’ City â†’ Address
â”‚   â””â”€â”€ Customers: Segment â†’ Demographics
â””â”€â”€ Measures:
    â”œâ”€â”€ Sales Amount
    â”œâ”€â”€ Quantity Sold
    â”œâ”€â”€ Profit
    â””â”€â”€ Returns
```

## ğŸ”— Related Technologies

### ğŸŒ Business Intelligence:
- ğŸ“Š **Data Mining** â€” data mining
- ğŸª **Data Mart** â€” data marts
- ğŸ“ˆ **MDX** â€” Multidimensional Expressions
- ğŸ” **XML for Analysis**

### ğŸ› ï¸ Popular OLAP Systems:
- **Microsoft Analysis Services**
- **Oracle OLAP**
- **Apache Kylin**
- **ClickHouse**

---

## ğŸ’¡ Key Advantages of OLAP Cube

| Advantage                 | Description                                    |
| ------------------------- | ---------------------------------------------- |
| **âš¡ Fast Response**       | Instant answers to complex analytical queries  |
| **ğŸ” Multidimensionality** | Data analysis from different perspectives      |
| **ğŸ“Š Flexibility**         | Interactive data exploration                   |
| **ğŸ¯ Intuitiveness**       | Visualization understandable to business users |

---

## ğŸ“‹ Comparison Table: OLTP vs OLAP

**OLTP** is typically contrasted with **Online Analytical Processing (OLAP)**:

| Characteristic  | OLTP ğŸš€                                   | OLAP ğŸ“Š                            |
| --------------- | ---------------------------------------- | --------------------------------- |
| **Query Types** | All types (read, insert, update, delete) | Mostly read-only                  |
| **Complexity**  | Simple queries                           | Complex analytical queries        |
| **Volume**      | Large number of simple queries           | Smaller number of complex queries |
| **Purpose**     | Operation processing                     | Business analytics and reporting  |

## ğŸ¢ Data Warehousing

### Why do we need a data warehouse?
Large companies can have **dozens of different transaction processing systems**:
- Customer websites ğŸŒ
- Point-of-sale systems (cash registers) in stores ğŸª
- Warehouse inventory tracking systems ğŸ“¦
- Transportation route planning systems ğŸšš
- Human resources management systems ğŸ‘¥

**Problem**: OLTP systems must be highly available and process transactions with low latency. Analytical queries often require scanning large volumes of data and can interfere with transaction operations.

**Solution**: **Data Warehouse** â€” a separate database where analysts can run any queries without affecting OLTP operations.

### ğŸ”„ ETL Process (Extractâ€“Transformâ€“Load)
Data enters the warehouse through the **ETL** process:
1. **Extract** - data is extracted from OLTP systems
2. **Transform** - data is transformed into a schema convenient for analysis
3. **Load** - data is loaded into the warehouse

**Real-life example**: A large bank ğŸ¦ might have separate systems for:
- Mobile banking ğŸ“±
- Credit operations ğŸ’³
- Mortgage products ğŸ 
- Investment services ğŸ“ˆ

All this data is combined in a data warehouse for end-to-end analytics.

## â­ Star and â„ï¸ Snowflake: Schemas for Analytics

### ğŸŒŸ Star Schema
At the center of the schema is a **fact table**, surrounded by **dimension tables**.

**Example for retail**:
- `fact_sales` (sales fact table) - at the center
- `dim_product` (product dimension) ğŸ“¦
- `dim_store` (store dimension) ğŸª
- `dim_time` (time dimension) â°
- `dim_customer` (customer dimension) ğŸ‘¥

**C Example:**
```c
// Structure for sales fact table
struct FactSale {
    int sale_id;
    int product_id;     // reference to dim_product
    int store_id;       // reference to dim_store
    int time_id;        // reference to dim_time
    int customer_id;    // reference to dim_customer
    double amount;
    int quantity;
    double profit;
};

// Structure for product dimension table
struct DimProduct {
    int product_id;
    char sku[20];
    char description[100];
    char brand[50];
    char category[50];
    double price;
};
```

### â„ï¸ Snowflake Schema
A more normalized version of the star schema where dimensions are further broken down into sub-dimensions.

**Advantage of star schema**: simpler for analysts!

## ğŸ’¾ Data Warehouse Features

- **Wide tables**: fact tables often have more than 100 columns ğŸ“‹
- **Rich metadata**: dimension tables contain all possible information for analysis
- **Optimized for analytical queries**: special storage structures and algorithms

---

# Quick Summary: OLTP vs OLAP

## ğŸ¯ **Key Differences**

**OLTP (Online Transaction Processing)**
- ğŸ’° **Real-time operation processing**
- ğŸ”„ **Short transactions** (read/write)
- âš¡ **High availability**, instant response
- ğŸ¦ **Examples**: bank transfers, orders, bookings

**OLAP (Online Analytical Processing)**
- ğŸ“Š **Analytics and reporting**
- ğŸ” **Complex queries** on big data
- ğŸ“ˆ **Multidimensional analysis** (cubes, slices, drill-down)
- ğŸ§  **Examples**: business intelligence, forecasting

## ğŸ—ï¸ **Architectural Features**

**OLTP**
- ACID transactions ğŸ›¡ï¸
- Normalized schemas
- Write optimization

**OLAP**
- Denormalized schemas (ğŸŒŸ **Star**/â„ï¸ **Snowflake**)
- Data warehouses
- ETL processes
- Read optimization

## ğŸ’¡ **What This Means in Practice**

| Aspect      | OLTP                  | OLAP                |
| ----------- | --------------------- | ------------------- |
| **Purpose** | Business operations ğŸš€ | Business analysis ğŸ“ˆ |
| **Data**    | Current operations    | Historical data     |
| **Users**   | Operators             | Analysts            |

**Conclusion**: OLTP ensures the company's daily operations, while OLAP helps understand trends and make strategic decisions. Both approaches are critically important but solve different problems.